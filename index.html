<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="description" content="Clear Ground - Energy Work Session Manager & Development Tracker">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- OneSignal Push Notifications -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    
    <title>Clear Ground</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Animated Background Canvas -->
    <canvas id="backgroundCanvas"></canvas>

    <!-- Loading Screen -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-icon">
            <img src="icons/icon.svg" alt="Clear Ground">
        </div>
        <div class="loading-app-name">Clear Ground</div>
        <div class="loading-text">Connecting to the source...</div>
        <div class="loading-dots">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Global Header -->
        <header class="global-header">
            <div class="global-header-left">
                <img src="icons/icon.svg" alt="" class="global-header-icon" id="headerLogo">
                <span class="global-header-title">Clear Ground</span>
            </div>
            <div class="global-header-right">
                <button id="wakeLockBtn" class="wake-lock-btn" onclick="toggleWakeLock()" title="Keep screen awake">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                </button>
                <select id="currentUser" class="user-selector">
                    <option value="">Loading...</option>
                </select>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="content-area">
            <!-- Dashboard View (Default) -->
            <section id="viewDashboard" class="view active">
                <!-- Hero Section with Icon -->
                <div class="dashboard-hero">
                    <img src="icons/icon.svg" alt="" class="hero-icon">
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <button class="action-btn" onclick="showView('track')">
                        <span class="btn-icon">‚óé</span>
                        <span class="btn-text">Track Progress</span>
                    </button>
                    <button class="action-btn" onclick="showView('timer')">
                        <span class="btn-icon">‚è±</span>
                        <span class="btn-text">Do a Session</span>
                    </button>
                    <button class="action-btn" onclick="showView('playlists')">
                        <span class="btn-icon">‚ñ∂</span>
                        <span class="btn-text">Programs</span>
                    </button>
                    <button class="action-btn" onclick="showView('stats')">
                        <span class="btn-icon">‚ò∞</span>
                        <span class="btn-text">Statistics</span>
                    </button>
                </div>

                <!-- Stats Summary (moved below actions) -->
                <div class="stats-summary">
                    <div class="stat-card">
                        <span class="stat-value" id="statTotalMarkers">-</span>
                        <span class="stat-label">Markers</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="statTodaySessions">-</span>
                        <span class="stat-label">Today</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="statTotalTime">-</span>
                        <span class="stat-label">Total</span>
                    </div>
                </div>

                <!-- Signal Card -->
                <div class="signal-home-card" onclick="showView('signal')">
                    <div class="signal-home-icon">‚ö°</div>
                    <div class="signal-home-content">
                        <div class="signal-home-title">Daily Signal</div>
                        <div class="signal-home-stats">
                            <span id="signalTodayProgress">0 of 1 today</span>
                            <span class="signal-streak" id="signalStreakDisplay">üî• 0 day streak</span>
                        </div>
                    </div>
                    <div class="signal-home-arrow">‚Üí</div>
                </div>

                <!-- Habit Tracker Card -->
                <div class="habit-home-card" onclick="showView('habits')">
                    <div class="habit-home-icon">‚úì</div>
                    <div class="habit-home-content">
                        <div class="habit-home-title">Daily Habits</div>
                        <div class="habit-home-stats">
                            <span id="habitTodayProgress">0 of 6 today</span>
                            <span class="habit-streak" id="habitStreakDisplay">üî• 0 day streak</span>
                        </div>
                    </div>
                    <div class="habit-home-arrow">‚Üí</div>
                </div>

                <!-- Attunements Card -->
                <div class="attunement-home-card" onclick="showView('attunements')">
                    <div class="attunement-home-icon">‚ú¶</div>
                    <div class="attunement-home-content">
                        <div class="attunement-home-title">Attunements</div>
                        <div class="attunement-home-stats">
                            <span id="attunementReceivedCount">0 received</span>
                            <span class="attunement-available" id="attunementAvailableCount">0 available</span>
                        </div>
                    </div>
                    <div class="attunement-home-arrow">‚Üí</div>
                </div>

                <!-- Shadow Card -->
                <div class="shadow-home-card" onclick="showView('shadow')">
                    <div class="shadow-home-icon">‚óê</div>
                    <div class="shadow-home-content">
                        <div class="shadow-home-title">Shadow</div>
                        <div class="shadow-home-stats">
                            <span id="shadowOverallProgress">Integration & processing tools</span>
                        </div>
                    </div>
                    <div class="shadow-home-arrow">‚Üí</div>
                </div>

                <!-- Daily Check-in Card -->
                <div class="checkin-home-card" id="checkinHomeCard" onclick="startCheckin()">
                    <div class="checkin-home-icon">‚óâ</div>
                    <div class="checkin-home-content">
                        <div class="checkin-home-title">Daily Check-in</div>
                        <div class="checkin-home-stats">
                            <span id="checkinTodayStatus">20 seconds. Track your vibe.</span>
                        </div>
                    </div>
                    <div class="checkin-home-arrow">‚Üí</div>
                </div>

                <!-- Intentions Card -->
                <div class="intentions-home-card" onclick="showView('intentions')">
                    <div class="intentions-home-icon">‚òÖ</div>
                    <div class="intentions-home-content">
                        <div class="intentions-home-title">Intentions</div>
                        <div class="intentions-home-stats">
                            <span id="intentionsStatus">Your northstar guidance</span>
                        </div>
                    </div>
                    <div class="intentions-home-arrow">‚Üí</div>
                </div>
            </section>

            <!-- Signal View -->
            <section id="viewSignal" class="view">
                <div class="view-header">
                    <h2>Signal</h2>
                    <button class="btn small secondary" onclick="showView('signalHistory')">History</button>
                </div>

                <!-- Signal Stats -->
                <div class="signal-stats-bar">
                    <span class="signal-today-count">Today: <strong id="signalTodayCount">0</strong> of <strong id="signalDailyGoal">1</strong></span>
                    <span class="signal-streak-badge">üî• <span id="signalCurrentStreak">0</span> day streak</span>
                </div>

                <!-- Signal Prompt (before getting a signal) -->
                <div id="signalPrompt" class="signal-prompt">
                    <div class="signal-prompt-icon" onclick="getRandomSignal()">
                        <span class="signal-bolt">‚ö°</span>
                    </div>
                    <p class="signal-prompt-text">Tap to receive a Signal</p>
                    
                    <div class="signal-category-filter">
                        <label>Category:</label>
                        <select id="signalCategorySelect" onchange="updateSignalCategory()">
                            <option value="all">All</option>
                            <option value="recognize">Recognize</option>
                            <option value="create">Create</option>
                        </select>
                    </div>
                </div>

                <!-- Signal Display (when showing a signal) -->
                <div id="signalDisplay" class="signal-display hidden">
                    <!-- This will be replaced by fullscreen reader -->
                </div>
            </section>

            <!-- Signal Reader (Full-screen step-by-step view) -->
            <section id="viewSignalReader" class="view signal-reader-view">
                <button class="signal-reader-exit" onclick="confirmExitSignal()">‚úï</button>
                
                <div class="signal-reader-content" id="signalReaderContent">
                    <!-- Category badge -->
                    <div class="signal-reader-badge" id="readerCategoryBadge">RECOGNIZE</div>
                    
                    <!-- Lesson number (shown on title step) -->
                    <div class="signal-reader-number" id="readerLessonNumber">Lesson 1</div>
                    
                    <!-- Main content area -->
                    <div class="signal-reader-text" id="readerText">
                        <!-- Step content appears here -->
                    </div>
                    
                    <!-- Progress dots -->
                    <div class="signal-reader-dots" id="readerDots">
                        <!-- Dots generated dynamically -->
                    </div>
                </div>
                
                <!-- Navigation (during lesson) -->
                <div class="signal-reader-nav" id="readerNav">
                    <button class="signal-nav-btn" id="readerPrevBtn" onclick="prevSignalStep()">‚Üê Back</button>
                    <button class="signal-nav-btn skip" id="readerSkipBtn" onclick="skipSignal()">Skip</button>
                    <button class="signal-nav-btn primary" id="readerNextBtn" onclick="nextSignalStep()">Next ‚Üí</button>
                </div>
                
                <!-- End Screen (shown after last content step) -->
                <div class="signal-end-screen hidden" id="signalEndScreen">
                    <div class="signal-end-icon">‚úì</div>
                    <h2 class="signal-end-title">Well done.</h2>
                    <p class="signal-end-message">Take a moment to contemplate what was most meaningful for you in this Signal.</p>
                    
                    <div class="signal-rating">
                        <p class="signal-rating-label">Did this resonate with you?</p>
                        <div class="signal-rating-buttons">
                            <button class="signal-rating-btn" data-rating="down" onclick="rateSignal('down')">
                                <span class="rating-icon">üëé</span>
                            </button>
                            <button class="signal-rating-btn" data-rating="up" onclick="rateSignal('up')">
                                <span class="rating-icon">üëç</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="signal-end-actions">
                        <button class="signal-favorite-btn large" id="readerFavoriteBtn" onclick="toggleSignalFavorite()">
                            <span class="favorite-icon">‚ô°</span>
                            <span class="favorite-text">Save to Favorites</span>
                        </button>
                    </div>
                    
                    <button class="btn primary large signal-done-btn" onclick="completeSignal()">
                        ‚úì Complete
                    </button>
                </div>
            </section>

            <!-- Exit Signal Confirmation Modal -->
            <div id="exitSignalModal" class="modal small">
                <div class="modal-content">
                    <div class="modal-body" style="text-align: center; padding: var(--space-xl);">
                        <p style="margin-bottom: var(--space-lg);">Are you sure you want to exit this Signal?</p>
                        <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: var(--space-xl);">Your progress will not be saved.</p>
                        <div style="display: flex; gap: var(--space-md);">
                            <button class="btn secondary" onclick="closeExitSignalModal()" style="flex: 1;">Continue</button>
                            <button class="btn danger" onclick="confirmExitSignalNow()" style="flex: 1;">Exit</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Signal History View -->
            <section id="viewSignalHistory" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('signal')">‚Üê</button>
                    <h2>Signal History</h2>
                </div>

                <!-- History Tabs -->
                <div class="signal-history-tabs">
                    <button class="history-tab active" data-tab="favorites" onclick="switchHistoryTab('favorites')">
                        ‚ô° Favorites
                    </button>
                    <button class="history-tab" data-tab="completed" onclick="switchHistoryTab('completed')">
                        ‚úì Completed
                    </button>
                    <button class="history-tab" data-tab="skipped" onclick="switchHistoryTab('skipped')">
                        ‚Ü∑ Skipped
                    </button>
                </div>

                <!-- History List -->
                <div id="signalHistoryList" class="signal-history-list">
                    <p class="empty-state">No signals yet</p>
                </div>
            </section>

            <!-- Signal Detail Modal (for viewing from history) -->
            <div id="signalDetailModal" class="modal">
                <div class="modal-content large">
                    <div class="modal-header">
                        <span class="signal-category-badge" id="modalSignalCategory">RECOGNIZE</span>
                        <button class="close-btn" onclick="closeSignalDetailModal()">√ó</button>
                    </div>
                    <div class="modal-body">
                        <h3 class="signal-lesson-number" id="modalLessonNumber">Lesson 1</h3>
                        <h2 class="signal-lesson-title" id="modalLessonTitle">Title</h2>
                        <div class="signal-content" id="modalSignalContent"></div>
                    </div>
                    <div class="modal-footer">
                        <button class="signal-favorite-btn" id="modalFavoriteBtn" onclick="toggleModalFavorite()">
                            <span class="favorite-icon">‚ô°</span>
                        </button>
                        <button class="btn primary" onclick="closeSignalDetailModal()">Close</button>
                    </div>
                </div>
            </div>

            <!-- Signal Notification Banner -->
            <div id="signalNotificationBanner" class="signal-notification hidden">
                <div class="signal-notification-content">
                    <div class="signal-notification-icon">‚ö°</div>
                    <div class="signal-notification-text">
                        <div class="signal-notification-title">Your Daily Signal</div>
                        <div class="signal-notification-subtitle">Time for a moment of insight</div>
                    </div>
                </div>
                <div class="signal-notification-actions">
                    <button class="signal-notification-btn secondary" onclick="dismissSignalNotification('later')">Later</button>
                    <button class="signal-notification-btn primary" onclick="dismissSignalNotification('now')">Read Now</button>
                </div>
            </div>

            <!-- Habits View -->
            <section id="viewHabits" class="view">
                <div class="view-header">
                    <h2>Daily Habits</h2>
                </div>

                <!-- Date Display -->
                <div class="habits-date">
                    <span id="habitsCurrentDate">Today</span>
                </div>

                <!-- Habits Grid -->
                <div class="habits-grid" id="habitsGrid">
                    <!-- Habits will be dynamically inserted here -->
                </div>

                <!-- Habits Summary -->
                <div class="habits-summary">
                    <div class="habits-summary-item">
                        <span class="habits-summary-value" id="habitsCompletedCount">0</span>
                        <span class="habits-summary-label">Completed</span>
                    </div>
                    <div class="habits-summary-item">
                        <span class="habits-summary-value" id="habitsStreakCount">0</span>
                        <span class="habits-summary-label">Day Streak</span>
                    </div>
                </div>

                <!-- Quick Stats Link -->
                <div class="habits-footer">
                    <button class="btn secondary" onclick="showView('stats')">View Statistics</button>
                </div>
            </section>

            <!-- Habit Settings View -->
            <section id="viewHabitSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Habit Tracker</h2>
                </div>

                <div class="habit-settings-section">
                    <h3>Active Habits</h3>
                    <p class="settings-hint">Toggle habits to show/hide in tracker</p>
                    <div id="habitSettingsList" class="habit-settings-list">
                        <!-- Habit toggles will be dynamically inserted here -->
                    </div>
                </div>

                <div class="habit-settings-section">
                    <h3>Custom Habits</h3>
                    <div id="customHabitsList" class="custom-habits-list">
                        <!-- Custom habits will be dynamically inserted here -->
                    </div>
                    <div class="add-habit-form">
                        <input type="text" id="newHabitName" placeholder="New habit name..." maxlength="30">
                        <button class="btn primary" onclick="addCustomHabit()">Add</button>
                    </div>
                </div>
            </section>

            <!-- Attunements Browse View -->
            <section id="viewAttunements" class="view">
                <div class="view-header">
                    <h2>Attunements</h2>
                    <button class="btn small secondary" onclick="showView('myAttunements')">My Attunements</button>
                </div>

                <p class="attunements-intro">Receive energy attunements for healing and spiritual development</p>

                <!-- Attunements List -->
                <div class="attunements-list" id="attunementsList">
                    <!-- Attunements will be dynamically inserted here -->
                </div>
            </section>

            <!-- Attunement Detail View -->
            <section id="viewAttunementDetail" class="view attunement-detail-view">
                <button class="session-exit-btn" onclick="closeAttunementDetail()">‚úï</button>
                
                <div class="attunement-detail-header">
                    <span class="attunement-series-badge" id="attunementDetailSeries"></span>
                    <h2 id="attunementDetailName">Attunement Name</h2>
                    <div class="attunement-detail-meta">
                        <span id="attunementDetailDuration">30 min</span>
                    </div>
                </div>

                <div class="attunement-detail-content" id="attunementDetailContent">
                    <!-- Description pages will be shown here -->
                </div>

                <div class="attunement-detail-nav" id="attunementDetailNav">
                    <div class="attunement-dots" id="attunementDots"></div>
                </div>

                <div class="attunement-detail-footer">
                    <button class="btn secondary" id="attunementPrevBtn" onclick="prevAttunementPage()">‚Üê Back</button>
                    <button class="btn primary" id="attunementNextBtn" onclick="nextAttunementPage()">Continue ‚Üí</button>
                    <button class="btn primary hidden" id="attunementActivateBtn" onclick="startAttunement()">Begin Attunement</button>
                </div>

                <div class="attunement-locked-message hidden" id="attunementLockedMessage">
                    <div class="locked-icon">üîí</div>
                    <p id="attunementLockedText">This attunement will be available in X days</p>
                </div>
            </section>

            <!-- Attunement Process View (Timer) -->
            <section id="viewAttunementProcess" class="view attunement-process-view">
                <div class="attunement-process-header">
                    <h3 id="attunementProcessName">Attunement Name</h3>
                    <span class="attunement-process-series" id="attunementProcessSeries"></span>
                </div>

                <div class="attunement-process-visual">
                    <div class="attunement-orb">
                        <div class="attunement-orb-inner">‚ú¶</div>
                    </div>
                </div>

                <div class="attunement-process-timer">
                    <div class="attunement-countdown" id="attunementCountdown">00:00:00</div>
                    <div class="attunement-progress-bar">
                        <div class="attunement-progress-fill" id="attunementProgressFill"></div>
                    </div>
                    <p class="attunement-status" id="attunementStatus">Receiving attunement...</p>
                </div>

                <div class="attunement-process-controls">
                    <button class="btn danger" onclick="cancelAttunement()">Cancel</button>
                </div>
            </section>

            <!-- Attunement Complete View -->
            <section id="viewAttunementComplete" class="view attunement-complete-view">
                <div class="attunement-complete-content">
                    <div class="attunement-complete-icon">‚ú¶</div>
                    <h2>Attunement Complete</h2>
                    <p class="attunement-complete-name" id="attunementCompleteName">Divine Healing</p>
                    
                    <div class="attunement-usage-info" id="attunementUsageInfo">
                        <h3>How to Use This Energy</h3>
                        <div class="usage-content" id="attunementUsageContent">
                            <!-- Usage instructions will be shown here -->
                        </div>
                    </div>

                    <button class="btn primary" onclick="finishAttunement()">Done</button>
                </div>
            </section>

            <!-- My Attunements View -->
            <section id="viewMyAttunements" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('attunements')">‚Üê</button>
                    <h2>My Attunements</h2>
                </div>

                <div class="my-attunements-list" id="myAttunementsList">
                    <!-- User's received attunements will be shown here -->
                </div>

                <div class="my-attunements-empty hidden" id="myAttunementsEmpty">
                    <p>No attunements received yet</p>
                    <button class="btn secondary" onclick="showView('attunements')">Browse Attunements</button>
                </div>
            </section>

            <!-- Attunement Settings View -->
            <section id="viewAttunementSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Manage Attunements</h2>
                </div>

                <div class="attunement-settings-section">
                    <h3>Add New Attunement</h3>
                    
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="newAttunementName" placeholder="Attunement name..." maxlength="50">
                    </div>

                    <div class="form-group">
                        <label>Series (Optional)</label>
                        <select id="newAttunementSeries" onchange="onSeriesSelectChange()">
                            <option value="">No Series (Standalone)</option>
                            <!-- Series options will be added dynamically -->
                        </select>
                        <input type="text" id="newSeriesName" placeholder="Or create new series..." class="hidden">
                        <button class="btn small secondary" id="toggleNewSeries" onclick="toggleNewSeriesInput()">+ New Series</button>
                    </div>

                    <div class="form-group hidden" id="levelGroup">
                        <label>Level in Series</label>
                        <input type="number" id="newAttunementLevel" min="1" max="20" value="1">
                    </div>

                    <div class="form-group">
                        <label>Duration (minutes)</label>
                        <input type="number" id="newAttunementDuration" min="1" max="120" value="30">
                    </div>

                    <div class="form-group">
                        <label>Description (shown before attunement)</label>
                        <textarea id="newAttunementDescription" rows="4" placeholder="What is this attunement? What does it do?"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Usage Instructions (shown after attunement)</label>
                        <textarea id="newAttunementUsage" rows="4" placeholder="How to use this energy after receiving the attunement..."></textarea>
                    </div>

                    <button class="btn primary" onclick="addAttunement()">Add Attunement</button>
                </div>

                <div class="attunement-settings-section">
                    <h3>Existing Attunements</h3>
                    <div class="admin-attunements-list" id="adminAttunementsList">
                        <!-- Admin list of attunements will be shown here -->
                    </div>
                </div>
            </section>

            <!-- Shadow Settings View -->
            <section id="viewShadowSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Shadow Tools Settings</h2>
                </div>

                <div class="shadow-settings-content">
                    <div class="shadow-settings-section">
                        <h3>‚òØ Integrate - Daily Target</h3>
                        <p class="shadow-settings-description">How many polarities to integrate daily (max 50/day)</p>
                        <div class="shadow-settings-control">
                            <button class="btn small secondary" onclick="adjustIntegrateTarget(-5)">-5</button>
                            <span class="shadow-target-display" id="integrateTargetDisplay">15</span>
                            <button class="btn small secondary" onclick="adjustIntegrateTarget(5)">+5</button>
                        </div>
                        <div class="shadow-settings-level" id="integrateLevelDisplay">
                            <!-- Level display populated by JS -->
                        </div>
                    </div>

                    <div class="shadow-settings-section">
                        <h3>‚óâ Process - Daily Target</h3>
                        <p class="shadow-settings-description">How many emotions to process daily (max 50/day)</p>
                        <div class="shadow-settings-control">
                            <button class="btn small secondary" onclick="adjustProcessTarget(-5)">-5</button>
                            <span class="shadow-target-display" id="processTargetDisplay">15</span>
                            <button class="btn small secondary" onclick="adjustProcessTarget(5)">+5</button>
                        </div>
                        <div class="shadow-settings-level" id="processLevelDisplay">
                            <!-- Level display populated by JS -->
                        </div>
                    </div>

                    <div class="shadow-settings-info">
                        <h4>About Levels</h4>
                        <div class="shadow-levels-list">
                            <div class="shadow-level-item">
                                <span class="level-badge">1</span>
                                <span>First item completed</span>
                            </div>
                            <div class="shadow-level-item">
                                <span class="level-badge">2</span>
                                <span>10% complete</span>
                            </div>
                            <div class="shadow-level-item">
                                <span class="level-badge">3</span>
                                <span>25% complete</span>
                            </div>
                            <div class="shadow-level-item">
                                <span class="level-badge">4</span>
                                <span>50% complete</span>
                            </div>
                            <div class="shadow-level-item">
                                <span class="level-badge">5</span>
                                <span>75% complete</span>
                            </div>
                            <div class="shadow-level-item">
                                <span class="level-badge">6</span>
                                <span>100% - Mastery!</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Push Notifications Settings View -->
            <section id="viewPushSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Push Notifications</h2>
                </div>

                <div class="push-settings-content">
                    <!-- Main Enable/Disable -->
                    <div class="push-settings-section main-toggle">
                        <div class="push-toggle-row">
                            <div class="push-toggle-info">
                                <span class="push-toggle-label">Enable Notifications</span>
                                <span class="push-toggle-status" id="pushStatusText">Checking...</span>
                            </div>
                            <button class="btn primary" id="pushEnableBtn" onclick="togglePushNotifications()">Enable</button>
                        </div>
                        <p class="push-settings-note" id="pushNote">
                            Receive reminders for habits, session completions, and mindful moments.
                        </p>
                    </div>

                    <!-- Standard Notifications -->
                    <div class="push-settings-section" id="pushStandardSection">
                        <h3>Reminders</h3>
                        
                        <div class="push-setting-item">
                            <div class="push-setting-info">
                                <span class="push-setting-name">Daily Habits</span>
                                <span class="push-setting-desc">Remind me to complete daily habits</span>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="pushHabits" onchange="savePushSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="push-setting-time" id="pushHabitsTimeRow">
                            <span>Remind at:</span>
                            <input type="time" id="pushHabitsTime" value="08:00" onchange="savePushSettings()">
                        </div>

                        <div class="push-setting-item">
                            <div class="push-setting-info">
                                <span class="push-setting-name">Daily Signal</span>
                                <span class="push-setting-desc">Remind me to read today's signal</span>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="pushSignal" onchange="savePushSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="push-setting-time" id="pushSignalTimeRow">
                            <span>Remind at:</span>
                            <input type="time" id="pushSignalTime" value="07:00" onchange="savePushSettings()">
                        </div>

                        <div class="push-setting-item">
                            <div class="push-setting-info">
                                <span class="push-setting-name">Shadow Practice</span>
                                <span class="push-setting-desc">Remind me to integrate/process</span>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="pushShadow" onchange="savePushSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                        <div class="push-setting-time" id="pushShadowTimeRow">
                            <span>Remind at:</span>
                            <input type="time" id="pushShadowTime" value="20:00" onchange="savePushSettings()">
                        </div>

                        <div class="push-setting-item">
                            <div class="push-setting-info">
                                <span class="push-setting-name">Session Complete</span>
                                <span class="push-setting-desc">Notify when energy session ends</span>
                            </div>
                            <label class="toggle">
                                <input type="checkbox" id="pushSession" checked onchange="savePushSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <!-- Mindful Alerts (Random Reminders) -->
                    <div class="push-settings-section" id="pushAlertsSection">
                        <div class="push-section-header">
                            <h3>Mindful Alerts</h3>
                            <button class="btn small secondary" onclick="showAddAlertModal()">+ Add</button>
                        </div>
                        <p class="push-settings-note">Random reminders throughout your day</p>
                        
                        <div class="mindful-alerts-list" id="mindfulAlertsList">
                            <!-- Alerts populated by JS -->
                            <div class="empty-alerts-message" id="emptyAlertsMessage">
                                No mindful alerts yet. Add one to receive gentle reminders throughout your day.
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Add/Edit Mindful Alert Modal -->
            <div class="modal-overlay hidden" id="alertModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="alertModalTitle">Add Mindful Alert</h3>
                        <button class="modal-close" onclick="closeAlertModal()">‚úï</button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label>Alert Name</label>
                            <input type="text" id="alertName" placeholder="e.g., Gratitude, Be Present, Breathe">
                        </div>
                        <div class="form-group">
                            <label>Message</label>
                            <input type="text" id="alertMessage" placeholder="e.g., Take a moment to feel grateful">
                        </div>
                        <div class="form-group">
                            <label>How often?</label>
                            <select id="alertFrequency">
                                <option value="1">1 time per day</option>
                                <option value="2">2 times per day</option>
                                <option value="3" selected>3 times per day</option>
                                <option value="5">5 times per day</option>
                                <option value="8">8 times per day</option>
                                <option value="10">10 times per day</option>
                                <option value="15">15 times per day</option>
                                <option value="20">20 times per day</option>
                                <option value="25">25 times per day</option>
                                <option value="30">30 times per day</option>
                            </select>
                        </div>
                        <div class="form-group time-range">
                            <label>Active hours</label>
                            <div class="time-range-inputs">
                                <input type="time" id="alertStartTime" value="08:00">
                                <span>to</span>
                                <input type="time" id="alertEndTime" value="21:00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Open app to</label>
                            <select id="alertRedirect">
                                <option value="">None (dismiss only)</option>
                                <option value="dashboard">Home</option>
                                <option value="checkin">Daily Check-in</option>
                                <option value="intentions">Intentions</option>
                                <option value="signal">Daily Signal</option>
                                <option value="habits">Daily Habits</option>
                                <option value="shadow">Shadow</option>
                                <option value="integrate">Shadow - Integrate</option>
                                <option value="process">Shadow - Process</option>
                                <option value="deepClean">Shadow - Deep Clean</option>
                                <option value="liberation">Liberation Process</option>
                                <option value="timer">Energy Work</option>
                                <option value="playlists">Programs</option>
                                <option value="track">Track Progress</option>
                                <option value="awaken">Recognize</option>
                                <option value="attunements">Attunements</option>
                                <option value="stats">Statistics</option>
                                <option value="profile">Profile</option>
                            </select>
                            <p class="form-hint">Choose where to go when tapping "Let's go" on the notification</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn secondary" onclick="closeAlertModal()">Cancel</button>
                        <button class="btn primary" onclick="saveAlert()">Save</button>
                    </div>
                </div>
            </div>

            <!-- Shadow Main View -->
            <section id="viewShadow" class="view">
                <div class="view-header">
                    <h2>Shadow</h2>
                </div>

                <p class="shadow-intro">Tools for integrating polarities and processing emotional states from the subconscious</p>

                <div class="shadow-tools-grid">
                    <!-- Integrate Tool Card -->
                    <div class="shadow-tool-card" onclick="showView('integrate')">
                        <div class="shadow-tool-icon">‚òØ</div>
                        <div class="shadow-tool-content">
                            <h3>Integrate</h3>
                            <p>Work through polarities to achieve inner balance</p>
                            <div class="shadow-tool-progress">
                                <div class="shadow-progress-bar">
                                    <div class="shadow-progress-fill" id="integrateProgressBar" style="width: 0%"></div>
                                </div>
                                <span class="shadow-progress-text" id="integrateProgressText">0% complete</span>
                            </div>
                            <div class="shadow-tool-level" id="integrateLevelBadge"></div>
                        </div>
                        <div class="shadow-tool-arrow">‚Üí</div>
                    </div>

                    <!-- Process Tool Card -->
                    <div class="shadow-tool-card" onclick="showView('process')">
                        <div class="shadow-tool-icon">‚óâ</div>
                        <div class="shadow-tool-content">
                            <h3>Process</h3>
                            <p>Release emotional states and charges</p>
                            <div class="shadow-tool-progress">
                                <div class="shadow-progress-bar">
                                    <div class="shadow-progress-fill" id="processProgressBar" style="width: 0%"></div>
                                </div>
                                <span class="shadow-progress-text" id="processProgressText">0% complete</span>
                            </div>
                            <div class="shadow-tool-level" id="processLevelBadge"></div>
                        </div>
                        <div class="shadow-tool-arrow">‚Üí</div>
                    </div>

                    <!-- Liberation Tool Card -->
                    <div class="shadow-tool-card liberation" onclick="showView('liberation')">
                        <div class="shadow-tool-icon">‚ù§</div>
                        <div class="shadow-tool-content">
                            <h3>Liberation & Happiness</h3>
                            <p>Guided healing and energy restoration process</p>
                            <div class="shadow-tool-stats">
                                <span class="liberation-stat" id="liberationRoundsText">0 rounds</span>
                                <span class="liberation-streak" id="liberationStreakText">üî• 0 day streak</span>
                            </div>
                        </div>
                        <div class="shadow-tool-arrow">‚Üí</div>
                    </div>

                    <!-- Deep Clean Tool Card -->
                    <div class="shadow-tool-card" onclick="showView('deepClean')">
                        <div class="shadow-tool-icon">‚úß</div>
                        <div class="shadow-tool-content">
                            <h3>Deep Clean</h3>
                            <p>30-day subconscious cleansing process</p>
                            <div class="shadow-tool-status" id="deepCleanStatus">Not started</div>
                        </div>
                        <div class="shadow-tool-arrow">‚Üí</div>
                    </div>
                </div>
            </section>

            <!-- Integrate Main View -->
            <section id="viewIntegrate" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('shadow')">‚Üê</button>
                    <h2>Integrate</h2>
                    <button class="btn small secondary" onclick="showView('integrateHistory')">History</button>
                </div>

                <div class="integrate-stats-bar">
                    <span class="integrate-progress">
                        <span id="integrateCompletedCount">0</span> / <span id="integrateTotalCount">0</span> integrated
                    </span>
                    <span class="integrate-percentage" id="integratePercentage">0%</span>
                </div>

                <!-- Integrate Prompt -->
                <div id="integratePrompt" class="integrate-prompt">
                    <div class="integrate-prompt-icon" onclick="startNextIntegration()">
                        <span class="integrate-symbol">‚òØ</span>
                    </div>
                    <p class="integrate-prompt-text">Tap to integrate next polarity</p>
                </div>
            </section>

            <!-- Integrate Card View -->
            <section id="viewIntegrateCard" class="view integrate-reader-view">
                <button class="integrate-reader-exit" onclick="closeIntegrateCard()">‚úï</button>
                
                <div class="integrate-reader-content">
                    <!-- Progress indicator -->
                    <div class="integrate-reader-badge" id="integrateCardNumber">1 of 404</div>
                    
                    <!-- Polarity display (always visible) -->
                    <div class="polarity-display">
                        <span class="polarity-left" id="polarityLeft">absolute</span>
                        <span class="polarity-separator">‚Äî</span>
                        <span class="polarity-right" id="polarityRight">relative</span>
                    </div>
                    
                    <!-- Description text (scrollable if long) -->
                    <div class="integrate-reader-text" id="polarityDescription"></div>
                    
                    <!-- Progress dots for multi-page descriptions -->
                    <div class="integrate-reader-dots" id="integrateDots"></div>
                </div>
                
                <!-- Navigation (fixed at bottom) -->
                <div class="integrate-reader-nav" id="integrateNav">
                    <button class="integrate-nav-btn skip" onclick="skipIntegration()">Skip</button>
                    <button class="integrate-nav-btn primary" onclick="startIntegrationAnimation()">Integrate</button>
                </div>
                
                <!-- Integration Animation Screen -->
                <div class="integrate-animation-screen hidden" id="integrateAnimationScreen">
                    <div class="integrate-animation-polarity">
                        <span class="polarity-left" id="animPolarityLeft">absolute</span>
                        <span class="polarity-separator">‚Äî</span>
                        <span class="polarity-right" id="animPolarityRight">relative</span>
                    </div>
                    
                    <div class="integrate-animation-orb">
                        <div class="integrate-orb-inner">‚òØ</div>
                    </div>
                    
                    <div class="integrate-animation-timer" id="integrateAnimationTimer">10</div>
                    <p class="integrate-animation-text">Integrating...</p>
                    
                    <div class="integrate-animation-progress">
                        <div class="integrate-animation-bar" id="integrateAnimationBar"></div>
                    </div>
                </div>
                
                <!-- Integration Complete Screen -->
                <div class="integrate-complete-screen hidden" id="integrateCompleteScreen">
                    <div class="integrate-complete-icon">‚úì</div>
                    <h2 class="integrate-complete-title">Polarity Integrated</h2>
                    <div class="integrate-complete-polarity">
                        <span id="completePolarityLeft">absolute</span>
                        <span>‚Äî</span>
                        <span id="completePolarityRight">relative</span>
                    </div>
                    
                    <div class="complete-stats" id="integrateCompleteStats">
                        <!-- Stats populated by JS -->
                    </div>
                    
                    <div class="integrate-complete-actions">
                        <button class="btn secondary large" onclick="finishIntegration()">I feel done for now</button>
                        <button class="btn primary large" id="integrateContinueBtn" onclick="continueIntegration()">Continue to next</button>
                    </div>
                </div>
            </section>

            <!-- Integrate History View -->
            <section id="viewIntegrateHistory" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('integrate')">‚Üê</button>
                    <h2>Integration History</h2>
                </div>

                <div class="history-tabs">
                    <button class="tab-btn active" onclick="showIntegrateTab('completed')">Completed</button>
                    <button class="tab-btn" onclick="showIntegrateTab('skipped')">Skipped</button>
                </div>

                <div id="integrateHistoryList" class="shadow-history-list">
                    <!-- History items will be dynamically inserted here -->
                </div>
            </section>

            <!-- Process Main View -->
            <section id="viewProcess" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('shadow')">‚Üê</button>
                    <h2>Process</h2>
                    <button class="btn small secondary" onclick="showView('processHistory')">History</button>
                </div>

                <div class="process-stats-bar">
                    <span class="process-progress">
                        <span id="processCompletedCount">0</span> / <span id="processTotalCount">0</span> processed
                    </span>
                    <span class="process-percentage" id="processPercentage">0%</span>
                </div>

                <!-- Process Prompt -->
                <div id="processPrompt" class="process-prompt">
                    <div class="process-prompt-icon" onclick="startNextProcess()">
                        <span class="process-symbol">‚óâ</span>
                    </div>
                    <p class="process-prompt-text">Tap to process next emotional state</p>
                </div>
            </section>

            <!-- Process Card View -->
            <section id="viewProcessCard" class="view process-reader-view">
                <button class="process-reader-exit" onclick="closeProcessCard()">‚úï</button>
                
                <div class="process-reader-content">
                    <!-- Progress indicator -->
                    <div class="process-reader-badge" id="processCardNumber">1 of 700</div>
                    
                    <!-- Emotion display (always visible) -->
                    <div class="emotion-display">
                        <span class="emotion-name" id="emotionName">abandoned</span>
                    </div>
                    
                    <!-- Description text (scrollable if long) -->
                    <div class="process-reader-text" id="emotionDescription"></div>
                    
                    <!-- Progress dots for multi-page descriptions -->
                    <div class="process-reader-dots" id="processDots"></div>
                </div>
                
                <!-- Navigation (fixed at bottom) -->
                <div class="process-reader-nav" id="processNav">
                    <button class="process-nav-btn skip" onclick="skipProcess()">Skip</button>
                    <button class="process-nav-btn primary" onclick="startProcessAnimation()">Process</button>
                </div>
                
                <!-- Process Animation Screen -->
                <div class="process-animation-screen hidden" id="processAnimationScreen">
                    <div class="process-animation-emotion">
                        <span class="emotion-name" id="animEmotionName">abandoned</span>
                    </div>
                    
                    <div class="process-animation-orb">
                        <div class="process-orb-inner">‚óâ</div>
                    </div>
                    
                    <div class="process-animation-timer" id="processAnimationTimer">10</div>
                    <p class="process-animation-text">Processing...</p>
                    
                    <div class="process-animation-progress">
                        <div class="process-animation-bar" id="processAnimationBar"></div>
                    </div>
                </div>
                
                <!-- Process Complete Screen -->
                <div class="process-complete-screen hidden" id="processCompleteScreen">
                    <div class="process-complete-icon">‚úì</div>
                    <h2 class="process-complete-title">Emotional State Processed</h2>
                    <div class="process-complete-emotion">
                        <span id="completeEmotionName">abandoned</span>
                    </div>
                    
                    <div class="complete-stats" id="processCompleteStats">
                        <!-- Stats populated by JS -->
                    </div>
                    
                    <div class="process-complete-actions">
                        <button class="btn secondary large" onclick="finishProcess()">I feel done for now</button>
                        <button class="btn primary large" id="processContinueBtn" onclick="continueProcess()">Continue to next</button>
                    </div>
                </div>
            </section>

            <!-- Process History View -->
            <section id="viewProcessHistory" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('process')">‚Üê</button>
                    <h2>Process History</h2>
                </div>

                <div class="history-tabs">
                    <button class="tab-btn active" onclick="showProcessTab('completed')">Completed</button>
                    <button class="tab-btn" onclick="showProcessTab('skipped')">Skipped</button>
                </div>

                <div id="processHistoryList" class="shadow-history-list">
                    <!-- History items will be dynamically inserted here -->
                </div>
            </section>

            <!-- Deep Clean View -->
            <section id="viewDeepClean" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('shadow')">‚Üê</button>
                    <h2>Deep Clean</h2>
                </div>

                <div class="deep-clean-content">
                    <!-- Not Started State -->
                    <div id="deepCleanNotStarted" class="deep-clean-state">
                        <div class="deep-clean-icon">‚úß</div>
                        <h3>30-Day Deep Cleansing</h3>
                        <p class="deep-clean-description">
                            This process works while you sleep, clearing deep subconscious patterns over 30 days.
                            Once started, it runs automatically in the background.
                        </p>
                        <button class="btn primary large" onclick="startDeepClean()">Begin Deep Clean</button>
                    </div>

                    <!-- In Progress State -->
                    <div id="deepCleanInProgress" class="deep-clean-state hidden">
                        <div class="deep-clean-orb">
                            <div class="deep-clean-orb-inner">‚úß</div>
                        </div>
                        <h3>Deep Clean in Progress</h3>
                        <div class="deep-clean-progress">
                            <div class="deep-clean-days">
                                <span class="deep-clean-current" id="deepCleanCurrentDay">0</span>
                                <span class="deep-clean-separator">/</span>
                                <span class="deep-clean-total">30</span>
                            </div>
                            <span class="deep-clean-label">days complete</span>
                        </div>
                        <div class="deep-clean-progress-bar">
                            <div class="deep-clean-progress-fill" id="deepCleanProgressFill" style="width: 0%"></div>
                        </div>
                        <p class="deep-clean-status" id="deepCleanStatusText">Working while you sleep...</p>
                        <div class="deep-clean-actions">
                            <button class="btn secondary" id="deepCleanPauseBtn" onclick="toggleDeepCleanPause()">Pause</button>
                            <button class="btn danger" onclick="stopDeepClean()">Stop</button>
                        </div>
                    </div>

                    <!-- Completed State -->
                    <div id="deepCleanCompleted" class="deep-clean-state hidden">
                        <div class="deep-clean-complete-icon">‚úì</div>
                        <h3>Deep Clean Complete</h3>
                        <p class="deep-clean-description">
                            Congratulations! You have completed the 30-day deep cleansing process.
                        </p>
                        <p class="deep-clean-date" id="deepCleanCompletedDate">Completed on: -</p>
                    </div>
                </div>
            </section>

            <!-- Liberation Main View -->
            <section id="viewLiberation" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('shadow')">‚Üê</button>
                    <h2>Liberation & Happiness</h2>
                </div>

                <div class="liberation-stats-row">
                    <div class="liberation-stat-card">
                        <span class="liberation-stat-value" id="liberationTotalRounds">0</span>
                        <span class="liberation-stat-label">Total Rounds</span>
                    </div>
                    <div class="liberation-stat-card streak">
                        <span class="liberation-stat-value" id="liberationCurrentStreak">0</span>
                        <span class="liberation-stat-label">Day Streak üî•</span>
                    </div>
                </div>

                <div class="liberation-intro">
                    <p>A guided healing process that works through 8 stages to repair subtle bodies, return vitality, and activate wellbeing.</p>
                </div>

                <div class="liberation-instructions">
                    <h3>Before You Begin</h3>
                    <ul>
                        <li>Sit upright</li>
                        <li>Breathe naturally</li>
                        <li>After each line: pause and feel/notice what changes (sensations, breath, energy, emotion, spaciousness)</li>
                        <li>If something is clearly moving, stay longer before continuing</li>
                    </ul>
                </div>

                <div class="liberation-energy-toggle">
                    <div class="liberation-toggle-content">
                        <div class="liberation-toggle-info">
                            <span class="liberation-toggle-label">Enable Healing Energy</span>
                            <span class="liberation-toggle-description">Run Onelove transmission during the process</span>
                        </div>
                        <label class="toggle-switch">
                            <input type="checkbox" id="liberationEnergyToggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="liberation-start-prompt">
                    <div class="liberation-prompt-icon" onclick="startLiberationProcess()">
                        <span class="liberation-symbol">‚ù§</span>
                    </div>
                    <p class="liberation-prompt-text">Tap to begin the process</p>
                </div>
            </section>

            <!-- Liberation Process View -->
            <section id="viewLiberationProcess" class="view liberation-process-view">
                <button class="liberation-exit-btn" onclick="confirmExitLiberation()">‚úï</button>

                <div class="liberation-process-content">
                    <!-- Energy indicator -->
                    <div class="liberation-energy-indicator" id="liberationEnergyIndicator">
                        <span class="liberation-energy-dot"></span>
                        <span>Onelove healing active</span>
                    </div>

                    <!-- Stage indicator -->
                    <div class="liberation-stage-badge" id="liberationStageBadge">Stage 1 of 8</div>
                    <h3 class="liberation-stage-title" id="liberationStageTitle">Session Intention</h3>

                    <!-- Step text -->
                    <div class="liberation-step-text" id="liberationStepText">
                        "My intention is trauma and emotional healing, gently and safely, in a way my system can integrate."
                    </div>

                    <!-- Feel notice reminder -->
                    <p class="liberation-feel-notice">Feel/notice what changes: sensations, breath, energy, emotion, spaciousness</p>

                    <!-- Timer display -->
                    <div class="liberation-timer-display">
                        <div class="liberation-timer-circle">
                            <svg viewBox="0 0 100 100">
                                <circle class="liberation-timer-bg" cx="50" cy="50" r="45"></circle>
                                <circle class="liberation-timer-progress" id="liberationTimerCircle" cx="50" cy="50" r="45"></circle>
                            </svg>
                            <div class="liberation-timer-text" id="liberationTimerText">30</div>
                        </div>
                    </div>

                    <!-- Progress dots -->
                    <div class="liberation-step-dots" id="liberationStepDots"></div>
                </div>

                <div class="liberation-process-nav">
                    <button class="btn primary large" id="liberationProceedBtn" onclick="proceedLiberationStep()" disabled>
                        <span id="liberationProceedText">Please wait...</span>
                    </button>
                </div>
            </section>

            <!-- Liberation Complete View -->
            <section id="viewLiberationComplete" class="view liberation-complete-view">
                <div class="liberation-complete-content">
                    <div class="liberation-complete-icon">‚úì</div>
                    <h2 class="liberation-complete-title">Well Done</h2>
                    <p class="liberation-complete-subtitle">You have completed the Liberation & Happiness process</p>

                    <div class="liberation-closing-card">
                        <h3>Stage 9: Close & Integration</h3>
                        <p class="liberation-closing-instruction">
                            "I let everything settle. I don't need to figure anything out right now."
                        </p>
                        <p class="liberation-closing-optional">
                            Optional: lie down 5‚Äì10 minutes to integrate.
                        </p>
                    </div>

                    <div class="liberation-complete-stats">
                        <div class="liberation-complete-stat">
                            <span class="stat-value" id="liberationCompleteRounds">1</span>
                            <span class="stat-label">Total Rounds</span>
                        </div>
                        <div class="liberation-complete-stat">
                            <span class="stat-value" id="liberationCompleteStreak">1</span>
                            <span class="stat-label">Day Streak üî•</span>
                        </div>
                    </div>

                    <button class="btn primary large" onclick="closeLiberationComplete()">Done</button>
                </div>
            </section>

            <!-- Track Progress View -->
            <section id="viewTrack" class="view">
                <div class="view-header">
                    <h2>Track Progress</h2>
                </div>

                <!-- Filter Row -->
                <div class="filter-row">
                    <select id="categoryFilter" class="filter-group">
                        <option value="">All Categories</option>
                        <option value="Foundations">‚≠ê Foundations</option>
                    </select>
                    <div class="toggle-container">
                        <label class="toggle-switch">
                            <input type="checkbox" id="blindModeToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <label>Blind</label>
                    </div>
                </div>

                <!-- Markers List -->
                <div id="markersList" class="markers-list">
                    <p class="loading">Loading markers...</p>
                </div>

                <!-- Assessment Modal -->
                <div id="assessmentModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="assessmentMarkerName">Marker Name</h3>
                            <button class="close-btn" onclick="closeAssessmentModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <p id="assessmentDescription" class="marker-description"></p>
                            
                            <!-- Previous value shown when blind mode OFF -->
                            <div id="currentValueDisplay" class="current-value-display hidden">
                                <span class="current-value-label">Current value:</span>
                                <span id="currentValueAmount" class="current-value-amount">-</span>
                            </div>
                            
                            <div class="assessment-input">
                                <label>What do you sense now?</label>
                                <div class="slider-container">
                                    <input type="range" id="sensedValue" min="0" max="100" value="50">
                                    <div class="slider-value"><span id="sensedValueDisplay">50</span>%</div>
                                </div>
                            </div>

                            <div class="assessment-notes">
                                <label>Notes (optional)</label>
                                <textarea id="assessmentNotes" placeholder="Any observations..."></textarea>
                            </div>

                            <!-- Previous value reveal (shown after save in blind mode) -->
                            <div id="previousValueReveal" class="previous-reveal hidden">
                                <div class="reveal-content">
                                    <span class="reveal-label">Previous value was:</span>
                                    <span id="revealedPreviousValue" class="reveal-value">-</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button id="saveAssessmentBtn" class="btn primary" onclick="saveAssessment()">Save Assessment</button>
                            <button id="doneAssessmentBtn" class="btn secondary hidden" onclick="closeAssessmentModal()">Done</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Timer View -->
            <section id="viewTimer" class="view">
                <div class="view-header">
                    <h2>Energy Work</h2>
                    <div class="mode-toggle">
                        <span class="mode-label" id="modeLabelSimple">Simple</span>
                        <label class="toggle">
                            <input type="checkbox" id="advancedModeToggle" onchange="toggleEnergyMode()">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="mode-label" id="modeLabelAdvanced">Advanced</span>
                    </div>
                </div>

                <!-- Simple Mode Setup -->
                <div id="simpleSetup" class="simple-setup">
                    <div class="simple-section">
                        <label class="simple-label">Work on:</label>
                        <div class="work-options">
                            <button class="work-option" data-work="wisdom" onclick="selectWorkOption('wisdom')">
                                <span class="work-icon">‚óá</span>
                                <span class="work-name">Wisdom</span>
                            </button>
                            <button class="work-option" data-work="healing" onclick="selectWorkOption('healing')">
                                <span class="work-icon">‚ô°</span>
                                <span class="work-name">Healing</span>
                            </button>
                            <button class="work-option active" data-work="vitality" onclick="selectWorkOption('vitality')">
                                <span class="work-icon">‚ú¶</span>
                                <span class="work-name">Vitality</span>
                            </button>
                            <button class="work-option" data-work="custom" onclick="selectWorkOption('custom')">
                                <span class="work-icon">‚ö°</span>
                                <span class="work-name">Custom</span>
                            </button>
                            <button class="work-option" data-work="program" onclick="selectWorkOption('program')">
                                <span class="work-icon">‚ñ∂</span>
                                <span class="work-name">Program</span>
                            </button>
                            <button class="work-option" data-work="meditation" onclick="selectWorkOption('meditation')">
                                <span class="work-icon">‚óê</span>
                                <span class="work-name">Meditation</span>
                            </button>
                        </div>
                    </div>

                    <!-- Custom Transmission Dropdown (hidden by default) -->
                    <div id="simpleCustomSection" class="simple-section hidden">
                        <label class="simple-label">Transmission:</label>
                        <select id="simpleCustomTransmission" class="simple-dropdown">
                            <option value="">Select transmission...</option>
                        </select>
                    </div>

                    <!-- Program Dropdown (hidden by default) -->
                    <div id="simpleProgramSection" class="simple-section hidden">
                        <label class="simple-label">Program:</label>
                        <select id="simpleProgramSelect" class="simple-dropdown">
                            <option value="">Select program...</option>
                        </select>
                    </div>

                    <!-- Meditation Options (hidden by default) -->
                    <div id="simpleMeditationSection" class="simple-section hidden">
                        <div class="meditation-toggle-row">
                            <span class="meditation-label">Master of Mind transmission</span>
                            <label class="toggle">
                                <input type="checkbox" id="simpleMasterOfMind" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>

                    <div class="simple-section" id="simpleDurationSection">
                        <label class="simple-label">Duration:</label>
                        <div class="duration-selector">
                            <button class="duration-btn" onclick="adjustSimpleDuration(-5)">‚àí</button>
                            <span class="duration-display" id="simpleDurationDisplay">30 min</span>
                            <button class="duration-btn" onclick="adjustSimpleDuration(5)">+</button>
                        </div>
                    </div>

                    <div class="simple-start-container">
                        <button class="simple-start-btn" onclick="startSimpleSession()">
                            <img src="icons/icon.svg" alt="Start" class="simple-start-icon">
                        </button>
                        <p class="simple-start-hint">Tap to begin</p>
                    </div>
                </div>

                <!-- Simple Mode Active -->
                <div id="simpleActive" class="simple-active hidden">
                    <div class="simple-active-work" id="simpleActiveWork">Vitality</div>
                    
                    <div class="simple-timer-container">
                        <button class="simple-logo-btn pulsing" onclick="toggleSimpleTimerDisplay()">
                            <img src="icons/icon.svg" alt="" class="simple-logo-icon">
                        </button>
                        <div class="simple-timer" id="simpleTimerDisplay" onclick="toggleSimpleTimerDisplay()">00:00:00</div>
                        <div class="simple-timer-label" id="simpleTimerLabel">remaining</div>
                    </div>

                    <div class="simple-controls">
                        <button class="btn secondary" onclick="pauseTimer()" id="simplePauseBtn">
                            <span class="btn-icon">‚è∏</span> Pause
                        </button>
                        <button class="btn danger" onclick="endTimer()">
                            <span class="btn-icon">‚èπ</span> End
                        </button>
                    </div>
                </div>

                <!-- Advanced Mode Setup (shown when no timer running) -->
                <div id="timerSetup" class="timer-setup hidden">
                    <div class="form-group">
                        <label>What are you working on?</label>
                        <select id="timerMarkerSelect">
                            <option value="">Select marker...</option>
                            <option value="custom">‚ú¶ Custom / General</option>
                        </select>
                    </div>

                    <div id="customWorkInput" class="form-group hidden">
                        <label>Custom work description</label>
                        <input type="text" id="customWorkName" placeholder="e.g., General clearing">
                    </div>

                    <div class="form-group">
                        <label>Duration</label>
                        <div class="duration-presets">
                            <button class="preset-btn" onclick="setDuration(15)">15m</button>
                            <button class="preset-btn" onclick="setDuration(30)">30m</button>
                            <button class="preset-btn" onclick="setDuration(60)">1h</button>
                            <button class="preset-btn" onclick="setDuration(90)">1.5h</button>
                            <button class="preset-btn" onclick="setDuration(120)">2h</button>
                        </div>
                        <div class="custom-duration">
                            <input type="number" id="customDuration" min="1" max="1440" placeholder="Custom minutes">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Energy Type / Transmission</label>
                        <select id="energyType">
                            <option value="">Select type...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Intensity</label>
                        <div class="intensity-select">
                            <button class="intensity-btn" data-intensity="low">Low</button>
                            <button class="intensity-btn active" data-intensity="medium">Medium</button>
                            <button class="intensity-btn" data-intensity="high">High</button>
                            <button class="intensity-btn" data-intensity="highest">Highest</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Session Notes</label>
                        <textarea id="timerNotes" placeholder="Intentions, focus areas..."></textarea>
                    </div>

                    <button class="btn primary large" onclick="startTimer()">
                        <span class="btn-icon">‚ñ∂</span>
                        Start Session
                    </button>
                </div>

                <!-- Advanced Mode Active Timer (shown when timer running) -->
                <div id="timerActive" class="timer-active hidden">
                    <div class="timer-display">
                        <div class="timer-icon-pulse">
                            <img src="icons/icon.svg" alt="" class="timer-icon">
                        </div>
                        <div class="timer-target" id="timerTargetName">Target Name</div>
                        <div class="timer-countdown" id="timerCountdown">00:00:00</div>
                        <div class="timer-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="timerProgressBar"></div>
                            </div>
                        </div>
                        <span class="timer-percentage" id="timerPercentage">0%</span>
                    </div>

                    <div class="timer-info">
                        <div class="info-row">
                            <span class="info-label">Energy:</span>
                            <span id="timerEnergyType">-</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Intensity:</span>
                            <span id="timerIntensity">-</span>
                        </div>
                    </div>

                    <div class="timer-notes-display" id="timerNotesDisplay"></div>

                    <div class="timer-controls">
                        <button class="btn secondary" onclick="pauseTimer()" id="pauseBtn">
                            <span class="btn-icon">‚è∏</span> Pause
                        </button>
                        <button class="btn danger" onclick="endTimer()">
                            <span class="btn-icon">‚èπ</span> End Session
                        </button>
                    </div>
                </div>
            </section>

            <!-- Playlists View -->
            <section id="viewPlaylists" class="view">
                <div class="view-header">
                    <h2>Programs</h2>
                    <button class="btn small" onclick="showCreatePlaylist()">+ New</button>
                </div>

                <div id="playlistsList" class="playlists-list">
                    <p class="empty-state">No programs yet</p>
                </div>

                <button class="btn secondary full-width" id="addProgramBottomBtn" onclick="showCreatePlaylist()" style="margin-top: var(--space-md); display: none;">+ New Program</button>

                <!-- Create/Edit Playlist Modal -->
                <div id="playlistModal" class="modal">
                    <div class="modal-content large">
                        <div class="modal-header">
                            <h3 id="playlistModalTitle">Create Program</h3>
                            <button class="close-btn" onclick="closePlaylistModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Program Name</label>
                                <input type="text" id="playlistName" placeholder="e.g., Morning Routine">
                            </div>

                            <div class="playlist-items">
                                <h4>Items <button class="btn tiny" onclick="addPlaylistItem()">+ Add</button></h4>
                                <div id="playlistItemsList" class="playlist-items-sortable"></div>
                            </div>

                            <div class="playlist-total">
                                Total Duration: <span id="playlistTotalDuration">0 min</span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn secondary" onclick="closePlaylistModal()">Cancel</button>
                            <button class="btn primary" onclick="savePlaylist()">Save Program</button>
                        </div>
                    </div>
                </div>

                <!-- Running Program -->
                <div id="playlistRunner" class="playlist-runner hidden">
                    <div class="runner-header">
                        <h3 id="runningPlaylistName">Program Name</h3>
                        <div class="runner-progress">
                            <span id="runnerCurrentItem">1</span> / <span id="runnerTotalItems">5</span>
                        </div>
                    </div>
                    <div class="runner-current">
                        <div class="current-item-name" id="runnerItemName">Current Item</div>
                        <div class="current-item-timer" id="runnerItemTimer">00:00:00</div>
                        <div class="current-item-info" id="runnerItemInfo"></div>
                    </div>
                    <div class="runner-queue" id="runnerQueue"></div>
                    <div class="runner-controls">
                        <button class="btn secondary" onclick="pausePlaylist()" id="playlistPauseBtn">
                            <span class="btn-icon">‚è∏</span> Pause
                        </button>
                        <button class="btn secondary" onclick="skipPlaylistItem()">Skip ‚Üí</button>
                        <button class="btn danger" onclick="stopPlaylist()">Stop</button>
                    </div>
                </div>
            </section>

            <!-- Awaken View (Launcher) -->
            <section id="viewAwaken" class="view">
                <div class="view-header">
                    <h2>Recognize</h2>
                </div>

                <p class="awaken-intro">Guided practices for spiritual awakening</p>

                <!-- 2-Part Formula Practice Card -->
                <div class="practice-card" onclick="startAwakenPractice('2pf-full')">
                    <div class="practice-icon">‚óé</div>
                    <div class="practice-content">
                        <h3 class="practice-title">2-Part Formula</h3>
                        <p class="practice-description">See through the illusion of "me" by alternating between spacious awareness and investigating the sense of self.</p>
                        <div class="practice-meta">
                            <span class="practice-duration">‚è± 20-30 min</span>
                            <span class="practice-completed" id="practice2pfCompleted">‚úì 0 sessions</span>
                        </div>
                    </div>
                    <div class="practice-arrow">‚Üí</div>
                </div>

                <p class="coming-soon-text">More practices coming soon...</p>
            </section>

            <!-- Awaken Session View (Immersive) -->
            <section id="viewAwakenSession" class="view awaken-session-view">
                <button class="session-exit-btn" onclick="confirmExitSession()">‚úï</button>
                
                <div class="session-content">
                    <div class="session-text" id="sessionText">
                        <!-- Dynamic content inserted here -->
                    </div>
                    
                    <!-- Pause Timer (shown during timed steps) -->
                    <div class="session-timer hidden" id="sessionTimer">
                        <div class="timer-display" id="sessionTimerDisplay">0:45</div>
                        <div class="timer-progress">
                            <div class="timer-progress-bar" id="sessionTimerProgress"></div>
                        </div>
                    </div>
                    
                    <!-- Options (for scale/choice steps) -->
                    <div class="session-options hidden" id="sessionOptions">
                        <!-- Dynamic options inserted here -->
                    </div>
                    
                    <!-- Text Input (for reflection) -->
                    <div class="session-input hidden" id="sessionInputContainer">
                        <textarea id="sessionTextInput" placeholder="Share your reflection..." rows="4"></textarea>
                    </div>
                </div>
                
                <div class="session-footer">
                    <button class="session-continue-btn" id="sessionContinueBtn" onclick="advanceSession()">Continue</button>
                    <div class="session-progress" id="sessionProgress">
                        <!-- Dynamic progress dots -->
                    </div>
                </div>
            </section>

            <!-- Awaken Session Complete View -->
            <section id="viewAwakenComplete" class="view awaken-complete-view">
                <div class="complete-content">
                    <div class="complete-icon">‚úì</div>
                    <h2 class="complete-title">Session Complete</h2>
                    <p class="complete-message">Thank you for practicing.</p>
                    
                    <div class="complete-summary" id="completeSummary">
                        <!-- Dynamic summary inserted here -->
                    </div>
                    
                    <button class="btn primary large" onclick="finishAwakenSession()">Return to Recognize</button>
                </div>
            </section>

            <!-- Statistics View -->
            <section id="viewStats" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Statistics</h2>
                </div>

                <!-- Time Period Filter -->
                <div class="stats-filter">
                    <select id="statsPeriod" onchange="updateStats()">
                        <option value="7">Last 7 days</option>
                        <option value="30" selected>Last 30 days</option>
                        <option value="90">Last 90 days</option>
                        <option value="365">Last year</option>
                        <option value="all">All time</option>
                    </select>
                </div>

                <!-- Summary Cards -->
                <div class="stats-summary">
                    <div class="stat-card">
                        <span class="stat-value" id="statsSessions">-</span>
                        <span class="stat-label">Sessions</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="statsTotalHours">-</span>
                        <span class="stat-label">Total Hours</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-value" id="statsAvgSession">-</span>
                        <span class="stat-label">Avg Session</span>
                    </div>
                </div>

                <!-- Charts Section -->
                <div class="stats-charts">
                    <div class="chart-card">
                        <h3>Session Time by Day</h3>
                        <div class="chart-container">
                            <canvas id="dailyChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <h3>Time by Marker</h3>
                        <div id="markerBreakdown" class="breakdown-list"></div>
                    </div>

                    <div class="chart-card">
                        <h3>Recent Activity</h3>
                        <div id="recentActivityList" class="activity-list"></div>
                    </div>

                    <div class="chart-card">
                        <h3>Progress Trends</h3>
                        <div class="form-group">
                            <select id="progressTrendMarker" onchange="updateProgressTrend()">
                                <option value="">Select marker...</option>
                            </select>
                        </div>
                        <div class="chart-container">
                            <canvas id="progressChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <h3>Session Correlation</h3>
                        <p class="chart-description">Time spent vs. progress improvement</p>
                        <div id="correlationView" class="correlation-list"></div>
                    </div>

                    <div class="chart-card">
                        <h3>Signal Progress</h3>
                        <div class="signal-stats-grid">
                            <div class="signal-stat-item">
                                <span class="signal-stat-value" id="statsSignalTotal">0</span>
                                <span class="signal-stat-label">Total Completed</span>
                            </div>
                            <div class="signal-stat-item">
                                <span class="signal-stat-value" id="statsSignalStreak">0</span>
                                <span class="signal-stat-label">Current Streak</span>
                            </div>
                            <div class="signal-stat-item">
                                <span class="signal-stat-value" id="statsSignalBest">0</span>
                                <span class="signal-stat-label">Best Streak</span>
                            </div>
                            <div class="signal-stat-item">
                                <span class="signal-stat-value" id="statsSignalFavorites">0</span>
                                <span class="signal-stat-label">Favorites</span>
                            </div>
                        </div>
                    </div>

                    <div class="chart-card">
                        <h3>Habit Tracker</h3>
                        <div class="habit-stats-grid" id="habitStatsGrid">
                            <!-- Habit stats will be dynamically inserted here -->
                        </div>
                        <div class="habit-stats-summary">
                            <div class="habit-stat-row">
                                <span>Current Streak</span>
                                <strong id="statsHabitStreak">0 days</strong>
                            </div>
                            <div class="habit-stat-row">
                                <span>Best Streak</span>
                                <strong id="statsHabitBestStreak">0 days</strong>
                            </div>
                            <div class="habit-stat-row">
                                <span>Completion Rate</span>
                                <strong id="statsHabitCompletionRate">0%</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- History View -->
            <section id="viewHistory" class="view">
                <div class="view-header">
                    <h2>History</h2>
                    <div class="history-tabs">
                        <button class="tab-btn active" onclick="showHistoryTab('sessions')">Sessions</button>
                        <button class="tab-btn" onclick="showHistoryTab('progress')">Progress</button>
                    </div>
                </div>

                <div id="historySessionsTab" class="history-tab active">
                    <div id="sessionsHistoryList" class="history-list">
                        <p class="loading">Loading sessions...</p>
                    </div>
                </div>

                <div id="historyProgressTab" class="history-tab">
                    <div class="filter-group">
                        <select id="progressMarkerFilter">
                            <option value="">All Markers</option>
                        </select>
                    </div>
                    <div id="progressHistoryList" class="history-list">
                        <p class="loading">Loading progress...</p>
                    </div>
                </div>
            </section>

            <!-- Settings View -->
            <section id="viewSettings" class="view">
                <div class="view-header">
                    <h2>Settings</h2>
                </div>

                <!-- Profile Card -->
                <div class="profile-card" onclick="showView('profile')">
                    <div class="profile-card-icon">üë§</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">My Profile</div>
                        <div class="profile-card-subtitle">Intentions & Network Connection</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Statistics Card -->
                <div class="profile-card" onclick="showView('stats')">
                    <div class="profile-card-icon">‚ñ§</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Statistics</div>
                        <div class="profile-card-subtitle">Progress & Charts</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Energy Transmissions Card -->
                <div class="profile-card" onclick="showView('transmissions')">
                    <div class="profile-card-icon">‚ö°</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Energy Transmissions</div>
                        <div class="profile-card-subtitle">Custom energy types</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Signal Preferences Card -->
                <div class="profile-card" onclick="showView('signalSettings')">
                    <div class="profile-card-icon">üì°</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Signal Preferences</div>
                        <div class="profile-card-subtitle">Daily signals & categories</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Habit Tracker Card -->
                <div class="profile-card" onclick="showView('habitSettings')">
                    <div class="profile-card-icon">‚úì</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Habit Tracker</div>
                        <div class="profile-card-subtitle">Manage daily habits</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Attunements Settings Card -->
                <div class="profile-card" onclick="showView('attunementSettings')">
                    <div class="profile-card-icon">‚ú¶</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Attunements</div>
                        <div class="profile-card-subtitle">Manage energy attunements</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Shadow Tools Settings Card -->
                <div class="profile-card" onclick="showView('shadowSettings')">
                    <div class="profile-card-icon">‚òØ</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Shadow Tools</div>
                        <div class="profile-card-subtitle">Daily targets for Integrate & Process</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Push Notifications Settings Card -->
                <div class="profile-card" onclick="showView('pushSettings')">
                    <div class="profile-card-icon">üîî</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Push Notifications</div>
                        <div class="profile-card-subtitle">Reminders & mindful alerts</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <!-- Daily Check-in Settings Card -->
                <div class="profile-card" onclick="showView('checkinSettings')">
                    <div class="profile-card-icon">‚óâ</div>
                    <div class="profile-card-content">
                        <div class="profile-card-title">Daily Check-in</div>
                        <div class="profile-card-subtitle">Reminders & view trends</div>
                    </div>
                    <div class="profile-card-arrow">‚Üí</div>
                </div>

                <div class="settings-section">
                    <h3>Notifications</h3>
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>Sound on completion</span>
                            <span class="settings-hint">Play chime when timer ends</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="settingSoundEnabled" onchange="saveSetting('soundEnabled', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>Vibration on completion</span>
                            <span class="settings-hint">Vibrate when timer ends</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="settingVibrationEnabled" onchange="saveSetting('vibrationEnabled', this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Users</h3>
                    <div id="usersList" class="users-list"></div>
                    <button class="btn secondary" onclick="showAddUserModal()">+ Add User</button>
                </div>

                <div class="settings-section">
                    <h3>Markers</h3>
                    <button class="btn secondary" onclick="showAddMarkerModal()">+ Add Custom Marker</button>
                </div>

                <div class="settings-section">
                    <h3>Data</h3>
                    <button class="btn secondary" onclick="exportData()">Export Data</button>
                    <button class="btn secondary" onclick="syncData()">Sync Now</button>
                </div>

                <div class="settings-section">
                    <h3>About</h3>
                    <p class="version">Clear Ground v5.8.0</p>
                    <p class="copyright">Professional Energy Work Management</p>
                </div>
            </section>

            <!-- Profile View -->
            <section id="viewProfile" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>My Profile</h2>
                </div>

                <!-- User Info -->
                <div class="profile-user-info">
                    <div class="profile-avatar">üë§</div>
                    <div class="profile-username" id="profileUsername">User</div>
                </div>

                <!-- Network Connection Card -->
                <div class="network-card" id="networkCard">
                    <div class="network-header">
                        <div class="network-icon" id="networkIcon">‚óé</div>
                        <div class="network-title">Clear Ground Network</div>
                        <label class="toggle">
                            <input type="checkbox" id="networkConnectedToggle" onchange="toggleNetworkConnection(this.checked)">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="network-description">
                        <p id="networkStatus">I open myself to receive energy work that serves my highest good and spiritual evolution.</p>
                    </div>
                </div>

                <!-- Link to Intentions Settings -->
                <div class="profile-link-card" onclick="showView('intentionsSettings')">
                    <div class="profile-link-icon">‚òÖ</div>
                    <div class="profile-link-content">
                        <div class="profile-link-title">Northstar Intentions</div>
                        <div class="profile-link-subtitle">Edit your intentions and guidance</div>
                    </div>
                    <div class="profile-link-arrow">‚Üí</div>
                </div>

                <p class="privacy-note">üîí Your intentions are private and only visible to you.</p>
            </section>

            <!-- Transmissions View -->
            <section id="viewTransmissions" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Energy Transmissions</h2>
                </div>

                <p class="settings-hint" style="margin-bottom: var(--space-lg);">Custom energy types for timer & programs. These represent different healing modalities or energy sources you work with.</p>
                
                <div id="transmissionsList" class="transmissions-list"></div>
                
                <div class="add-transmission-row" style="margin-top: var(--space-lg);">
                    <input type="text" id="newTransmissionName" placeholder="New transmission name...">
                    <button class="btn small" onclick="addTransmission()">Add</button>
                </div>
            </section>

            <!-- Signal Settings View -->
            <section id="viewSignalSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Signal Preferences</h2>
                </div>

                <!-- Daily Goal -->
                <div class="signal-settings-section">
                    <h3>Daily Goal</h3>
                    <p class="settings-hint">How many signals per day?</p>
                    <div class="signal-goal-selector">
                        <button class="signal-goal-btn" onclick="adjustSignalGoal(-1)">‚àí</button>
                        <span class="signal-goal-value" id="signalGoalValue">1</span>
                        <button class="signal-goal-btn" onclick="adjustSignalGoal(1)">+</button>
                    </div>
                </div>

                <!-- Time Window -->
                <div class="signal-settings-section">
                    <h3>Time Window</h3>
                    <p class="settings-hint">When can signals appear?</p>
                    <div class="signal-time-row">
                        <select id="signalWindowStart" onchange="saveSignalSettings()">
                            <option value="6">6:00 AM</option>
                            <option value="7">7:00 AM</option>
                            <option value="8" selected>8:00 AM</option>
                            <option value="9">9:00 AM</option>
                            <option value="10">10:00 AM</option>
                        </select>
                        <span>to</span>
                        <select id="signalWindowEnd" onchange="saveSignalSettings()">
                            <option value="18">6:00 PM</option>
                            <option value="19">7:00 PM</option>
                            <option value="20" selected>8:00 PM</option>
                            <option value="21">9:00 PM</option>
                            <option value="22">10:00 PM</option>
                        </select>
                    </div>
                </div>

                <!-- Categories -->
                <div class="signal-settings-section">
                    <h3>Categories</h3>
                    <p class="settings-hint">Enable categories and adjust their ratio</p>
                    
                    <!-- Foundations -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-foundations" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Foundations</span>
                            <span class="signal-category-ratio" id="ratio-foundations">20%</span>
                        </div>
                        <input type="range" id="signalRatio-foundations" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="foundations" onclick="setSignalOrder('foundations', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="foundations" onclick="setSignalOrder('foundations', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Presence -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-presence" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Presence</span>
                            <span class="signal-category-ratio" id="ratio-presence">20%</span>
                        </div>
                        <input type="range" id="signalRatio-presence" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="presence" onclick="setSignalOrder('presence', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="presence" onclick="setSignalOrder('presence', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Collective Wisdom -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-collective-wisdom" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Collective Wisdom</span>
                            <span class="signal-category-ratio" id="ratio-collective-wisdom">20%</span>
                        </div>
                        <input type="range" id="signalRatio-collective-wisdom" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="collective-wisdom" onclick="setSignalOrder('collective-wisdom', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="collective-wisdom" onclick="setSignalOrder('collective-wisdom', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Creation -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-creation" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Creation</span>
                            <span class="signal-category-ratio" id="ratio-creation">20%</span>
                        </div>
                        <input type="range" id="signalRatio-creation" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="creation" onclick="setSignalOrder('creation', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="creation" onclick="setSignalOrder('creation', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Life, Business & Beyond -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-thought-leaders" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Life, Business & Beyond</span>
                            <span class="signal-category-ratio" id="ratio-thought-leaders">20%</span>
                        </div>
                        <input type="range" id="signalRatio-thought-leaders" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="thought-leaders" onclick="setSignalOrder('thought-leaders', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="thought-leaders" onclick="setSignalOrder('thought-leaders', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Nondual Understanding -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-nondual-understanding" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Nondual Understanding</span>
                            <span class="signal-category-ratio" id="ratio-nondual-understanding">20%</span>
                        </div>
                        <input type="range" id="signalRatio-nondual-understanding" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="nondual-understanding" onclick="setSignalOrder('nondual-understanding', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="nondual-understanding" onclick="setSignalOrder('nondual-understanding', 'random')">Random</button>
                        </div>
                    </div>
                    
                    <!-- Tantric Yoga -->
                    <div class="signal-category-setting">
                        <div class="signal-category-header">
                            <label class="toggle">
                                <input type="checkbox" id="signalCat-tantric-yoga" checked onchange="saveSignalSettings()">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="signal-category-name">Tantric Yoga</span>
                            <span class="signal-category-ratio" id="ratio-tantric-yoga">20%</span>
                        </div>
                        <input type="range" id="signalRatio-tantric-yoga" min="0" max="100" value="20" 
                               oninput="updateCategoryRatios()" onchange="saveSignalSettings()">
                        <div class="signal-order-toggle">
                            <span class="order-label">Order:</span>
                            <button class="order-btn active" data-order="sequential" data-cat="tantric-yoga" onclick="setSignalOrder('tantric-yoga', 'sequential')">1‚Üí2‚Üí3</button>
                            <button class="order-btn" data-order="random" data-cat="tantric-yoga" onclick="setSignalOrder('tantric-yoga', 'random')">Random</button>
                        </div>
                    </div>
                </div>

                <!-- Notifications -->
                <div class="signal-settings-section">
                    <h3>Notifications</h3>
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>Signal notifications</span>
                            <span class="settings-hint">Get reminded throughout the day</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="signalNotificationsEnabled" checked onchange="saveSignalSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Lesson Content -->
                <div class="signal-settings-section">
                    <h3>Lesson Content</h3>
                    <div class="signal-lesson-info" id="lessonCountsContainer">
                        <!-- Dynamically populated -->
                    </div>
                    <button class="btn secondary full-width" onclick="refreshSignalLessons()" style="margin-top: var(--space-md);">
                        ‚Üª Check for New Lessons
                    </button>
                </div>

                <!-- Stats Summary -->
                <div class="signal-settings-section">
                    <h3>Your Signal Stats</h3>
                    <div class="signal-stats-grid">
                        <div class="signal-stat-item">
                            <span class="signal-stat-value" id="settingsSignalTotal">0</span>
                            <span class="signal-stat-label">Total Completed</span>
                        </div>
                        <div class="signal-stat-item">
                            <span class="signal-stat-value" id="settingsSignalStreak">0</span>
                            <span class="signal-stat-label">Current Streak</span>
                        </div>
                        <div class="signal-stat-item">
                            <span class="signal-stat-value" id="settingsSignalBest">0</span>
                            <span class="signal-stat-label">Longest Streak</span>
                        </div>
                        <div class="signal-stat-item">
                            <span class="signal-stat-value" id="settingsSignalFavorites">0</span>
                            <span class="signal-stat-label">Favorites</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Daily Check-in Modal -->
            <section id="viewCheckin" class="view checkin-view">
                <div class="checkin-modal">
                    <!-- Intro Screen -->
                    <div class="checkin-screen active" data-step="intro">
                        <div class="checkin-header">
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <div class="checkin-intro-icon">‚óâ</div>
                            <h2 class="checkin-title">Daily Check-in</h2>
                            <p class="checkin-intro-text">Track your vibe in under 20 seconds. No need to overthink‚Äîpick the closest number for how you feel right now.</p>
                            <p class="checkin-intro-note">You'll get a note when your baseline shifts.</p>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Start</button>
                            <button class="btn secondary" onclick="skipCheckinToday()">Skip for today</button>
                        </div>
                    </div>

                    <!-- Step 1: Mood -->
                    <div class="checkin-screen" data-step="mood">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Step 1 of 5</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <h3 class="checkin-question">How do you feel overall right now?</h3>
                            <p class="checkin-context">This is your overall emotional tone. Over time, this helps you notice if your "normal" mood is lifting.</p>
                            <div class="checkin-slider-container">
                                <input type="range" class="checkin-slider" id="checkinMood" min="0" max="10" value="5" oninput="updateSliderValue('mood')">
                                <div class="checkin-slider-value" id="checkinMoodValue">5</div>
                                <div class="checkin-slider-labels">
                                    <span>Very bad</span>
                                    <span>Very good</span>
                                </div>
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 2: Stress -->
                    <div class="checkin-screen" data-step="stress">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Step 2 of 5</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <h3 class="checkin-question">How stressed do you feel right now?</h3>
                            <p class="checkin-context">Stress often shows up as tension, worry, or pressure. Tracking this helps you see if calm is becoming more stable.</p>
                            <div class="checkin-slider-container">
                                <input type="range" class="checkin-slider" id="checkinStress" min="0" max="10" value="5" oninput="updateSliderValue('stress')">
                                <div class="checkin-slider-value" id="checkinStressValue">5</div>
                                <div class="checkin-slider-labels">
                                    <span>Not stressed</span>
                                    <span>Extremely stressed</span>
                                </div>
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 3: Thoughts -->
                    <div class="checkin-screen" data-step="thoughts">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Step 3 of 5</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <h3 class="checkin-question">How busy is your mind right now?</h3>
                            <p class="checkin-context">This measures mental noise and looping thoughts. Many people notice progress as the mind becomes quieter and clearer.</p>
                            <div class="checkin-slider-container">
                                <input type="range" class="checkin-slider" id="checkinThoughts" min="0" max="10" value="5" oninput="updateSliderValue('thoughts')">
                                <div class="checkin-slider-value" id="checkinThoughtsValue">5</div>
                                <div class="checkin-slider-labels">
                                    <span>Very quiet</span>
                                    <span>Extremely busy</span>
                                </div>
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 4: Presence -->
                    <div class="checkin-screen" data-step="presence">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Step 4 of 5</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <h3 class="checkin-question">How present and aware do you feel?</h3>
                            <p class="checkin-context">Presence is how "here" you feel in this moment. Tracking this helps you notice gradual increases in clarity and groundedness.</p>
                            <div class="checkin-slider-container">
                                <input type="range" class="checkin-slider" id="checkinPresence" min="0" max="10" value="5" oninput="updateSliderValue('presence')">
                                <div class="checkin-slider-value" id="checkinPresenceValue">5</div>
                                <div class="checkin-slider-labels">
                                    <span>Lost in thoughts</span>
                                    <span>Very present</span>
                                </div>
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 5: Vitality -->
                    <div class="checkin-screen" data-step="vitality">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Step 5 of 5</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <h3 class="checkin-question">How energised do you feel right now?</h3>
                            <p class="checkin-context">Vitality is your sense of inner energy and liveliness. This can shift a lot with emotional clearing and awakening.</p>
                            <div class="checkin-slider-container">
                                <input type="range" class="checkin-slider" id="checkinVitality" min="0" max="10" value="5" oninput="updateSliderValue('vitality')">
                                <div class="checkin-slider-value" id="checkinVitalityValue">5</div>
                                <div class="checkin-slider-labels">
                                    <span>Exhausted</span>
                                    <span>Very energised</span>
                                </div>
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="nextCheckinStep()">Next</button>
                        </div>
                    </div>

                    <!-- Step 6: Tags + Note -->
                    <div class="checkin-screen" data-step="tags">
                        <div class="checkin-header">
                            <button class="checkin-back" onclick="prevCheckinStep()">‚Üê</button>
                            <span class="checkin-progress">Add context (optional)</span>
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body">
                            <p class="checkin-tags-intro">Skip if you want. This helps you remember what influenced your day.</p>
                            <div class="checkin-tags">
                                <button class="checkin-tag" data-tag="heavy-emotions" onclick="toggleCheckinTag(this)">Heavy emotions</button>
                                <button class="checkin-tag" data-tag="light-open" onclick="toggleCheckinTag(this)">Light / open</button>
                                <button class="checkin-tag" data-tag="triggered" onclick="toggleCheckinTag(this)">Triggered</button>
                                <button class="checkin-tag" data-tag="calm" onclick="toggleCheckinTag(this)">Calm</button>
                                <button class="checkin-tag" data-tag="breakthrough" onclick="toggleCheckinTag(this)">Breakthrough</button>
                                <button class="checkin-tag" data-tag="overthinking" onclick="toggleCheckinTag(this)">Overthinking</button>
                                <button class="checkin-tag" data-tag="flow" onclick="toggleCheckinTag(this)">Flow</button>
                                <button class="checkin-tag" data-tag="social-drain" onclick="toggleCheckinTag(this)">Social drain</button>
                                <button class="checkin-tag" data-tag="low-energy" onclick="toggleCheckinTag(this)">Low energy</button>
                                <button class="checkin-tag" data-tag="rested" onclick="toggleCheckinTag(this)">Rested</button>
                            </div>
                            <div class="checkin-note-container">
                                <label>Quick note (optional)</label>
                                <input type="text" id="checkinNote" maxlength="120" placeholder="What affected your vibe?">
                            </div>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="saveCheckin()">Save</button>
                        </div>
                    </div>

                    <!-- Result Screen -->
                    <div class="checkin-screen" data-step="result">
                        <div class="checkin-header">
                            <button class="checkin-close" onclick="closeCheckin()">‚úï</button>
                        </div>
                        <div class="checkin-body checkin-result">
                            <div class="checkin-result-icon">‚úì</div>
                            <h2 class="checkin-result-title">Saved</h2>
                            <div class="checkin-vibe-score">
                                <span class="vibe-label">Vibe Score</span>
                                <span class="vibe-value" id="checkinVibeScore">--</span>
                                <span class="vibe-max">/100</span>
                            </div>
                            <p class="checkin-result-text">Small daily check-ins add up. You'll get a note when your baseline shifts.</p>
                        </div>
                        <div class="checkin-footer">
                            <button class="btn primary" onclick="closeCheckin()">Done</button>
                            <button class="btn secondary" onclick="showView('checkinTrends')">View trends</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Check-in Settings View -->
            <section id="viewCheckinSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('settings')">‚Üê</button>
                    <h2>Daily Check-in</h2>
                </div>

                <!-- Enable/Disable Check-in -->
                <div class="settings-card">
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>Enable Daily Check-in</span>
                            <span class="settings-hint">Show check-in card on home screen</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="checkinEnabled" checked onchange="saveCheckinSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <!-- Reminder Settings -->
                <div class="settings-card">
                    <h3 class="settings-card-title">Reminder</h3>
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>Daily reminder</span>
                            <span class="settings-hint">Get notified to check in</span>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="checkinReminderEnabled" onchange="saveCheckinSettings()">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <div class="settings-row" id="checkinTimeRow">
                        <div class="settings-label">
                            <span>Reminder time</span>
                        </div>
                        <input type="time" id="checkinReminderTime" value="20:00" onchange="saveCheckinSettings()">
                    </div>
                </div>

                <!-- Trends Button -->
                <div class="settings-card clickable" onclick="showView('checkinTrends')">
                    <div class="settings-row">
                        <div class="settings-label">
                            <span>View Trends</span>
                            <span class="settings-hint">See your vibe score over time</span>
                        </div>
                        <span class="settings-arrow">‚Üí</span>
                    </div>
                </div>

                <!-- Stats -->
                <div class="settings-card">
                    <h3 class="settings-card-title">Statistics</h3>
                    <div class="checkin-settings-stats">
                        <div class="checkin-stat">
                            <span class="checkin-stat-value" id="checkinTotalCount">0</span>
                            <span class="checkin-stat-label">Total check-ins</span>
                        </div>
                        <div class="checkin-stat">
                            <span class="checkin-stat-value" id="checkinCurrentStreak">0</span>
                            <span class="checkin-stat-label">Current streak</span>
                        </div>
                        <div class="checkin-stat">
                            <span class="checkin-stat-value" id="checkinAvgVibe">--</span>
                            <span class="checkin-stat-label">Avg vibe (7 days)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Check-in Trends View -->
            <section id="viewCheckinTrends" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('checkinSettings')">‚Üê</button>
                    <h2>Trends</h2>
                </div>

                <!-- Vibe Score Overview -->
                <div class="trends-overview">
                    <div class="trends-current">
                        <span class="trends-label">Current Vibe</span>
                        <span class="trends-value" id="trendsCurrentVibe">--</span>
                        <span class="trends-baseline" id="trendsBaselineText">Baseline: --</span>
                    </div>
                </div>

                <!-- Vibe Chart -->
                <div class="trends-chart-container">
                    <h3>Last 30 Days</h3>
                    <div class="trends-chart" id="vibeChart">
                        <div class="trends-chart-empty" id="trendsEmptyState">
                            Check in a few more times to see your trend.
                        </div>
                        <canvas id="vibeChartCanvas"></canvas>
                    </div>
                </div>

                <!-- Metric Breakdown -->
                <div class="trends-metrics">
                    <h3>7-Day Averages</h3>
                    <div class="trends-metric-grid">
                        <div class="trends-metric">
                            <span class="metric-name">Mood</span>
                            <div class="metric-bar-container">
                                <div class="metric-bar" id="trendsMoodBar" style="width: 50%"></div>
                            </div>
                            <span class="metric-value" id="trendsMoodValue">--</span>
                        </div>
                        <div class="trends-metric">
                            <span class="metric-name">Calm</span>
                            <div class="metric-bar-container">
                                <div class="metric-bar" id="trendsStressBar" style="width: 50%"></div>
                            </div>
                            <span class="metric-value" id="trendsStressValue">--</span>
                        </div>
                        <div class="trends-metric">
                            <span class="metric-name">Clarity</span>
                            <div class="metric-bar-container">
                                <div class="metric-bar" id="trendsThoughtsBar" style="width: 50%"></div>
                            </div>
                            <span class="metric-value" id="trendsThoughtsValue">--</span>
                        </div>
                        <div class="trends-metric">
                            <span class="metric-name">Presence</span>
                            <div class="metric-bar-container">
                                <div class="metric-bar" id="trendsPresenceBar" style="width: 50%"></div>
                            </div>
                            <span class="metric-value" id="trendsPresenceValue">--</span>
                        </div>
                        <div class="trends-metric">
                            <span class="metric-name">Vitality</span>
                            <div class="metric-bar-container">
                                <div class="metric-bar" id="trendsVitalityBar" style="width: 50%"></div>
                            </div>
                            <span class="metric-value" id="trendsVitalityValue">--</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Check-ins -->
                <div class="trends-recent">
                    <h3>Recent Check-ins</h3>
                    <div id="recentCheckinsList" class="recent-checkins-list">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
            </section>

            <!-- Intentions View -->
            <section id="viewIntentions" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('dashboard')">‚Üê</button>
                    <h2>Intentions</h2>
                    <button class="header-action-btn" onclick="showView('intentionsSettings')">‚úé Edit</button>
                </div>

                <p class="intentions-view-intro">Your intentions guide the energy work you receive. They bring clarity and energetic alignment to your journey.</p>

                <!-- View-Only Intention Tabs -->
                <div class="intentions-view-tabs">
                    <button class="intentions-view-tab active" data-tab="release" onclick="switchIntentionsViewTab('release')">
                        <span class="tab-icon">‚Üì</span> Release
                    </button>
                    <button class="intentions-view-tab" data-tab="raise" onclick="switchIntentionsViewTab('raise')">
                        <span class="tab-icon">‚Üë</span> Raise
                    </button>
                    <button class="intentions-view-tab" data-tab="realize" onclick="switchIntentionsViewTab('realize')">
                        <span class="tab-icon">‚ú¶</span> Realize
                    </button>
                </div>

                <!-- Release Tab Content -->
                <div class="intentions-view-content active" id="intentionsViewRelease">
                    <div class="intention-view-card">
                        <div class="intention-view-label">Limiting Beliefs & Blocks</div>
                        <p class="intention-view-text" id="view_release_beliefs">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Negative Patterns</div>
                        <p class="intention-view-text" id="view_release_emotions">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Trauma & Habits</div>
                        <p class="intention-view-text" id="view_release_trauma">Not set</p>
                    </div>
                </div>

                <!-- Raise Tab Content -->
                <div class="intentions-view-content" id="intentionsViewRaise">
                    <div class="intention-view-card">
                        <div class="intention-view-label">Consciousness & Presence</div>
                        <p class="intention-view-text" id="view_raise_consciousness">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Developing Capacities</div>
                        <p class="intention-view-text" id="view_raise_intelligences">Not set</p>
                    </div>
                </div>

                <!-- Realize Tab Content -->
                <div class="intentions-view-content" id="intentionsViewRealize">
                    <div class="intention-view-card">
                        <div class="intention-view-label">Health & Vitality</div>
                        <p class="intention-view-text" id="view_realize_health">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Abundance & Purpose</div>
                        <p class="intention-view-text" id="view_realize_wealth">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Relationships & Connection</div>
                        <p class="intention-view-text" id="view_realize_relationships">Not set</p>
                    </div>
                    <div class="intention-view-card">
                        <div class="intention-view-label">Other Intentions</div>
                        <p class="intention-view-text" id="view_realize_other">Not set</p>
                    </div>
                </div>

                <p class="privacy-note">üîí Your intentions are private and only visible to you.</p>
            </section>

            <!-- Intentions Settings View -->
            <section id="viewIntentionsSettings" class="view">
                <div class="view-header">
                    <button class="back-btn" onclick="showView('intentions')">‚Üê</button>
                    <h2>Edit Intentions</h2>
                </div>

                <p class="intentions-intro">Tap any card to edit your intentions.</p>

                <!-- Intention Tabs -->
                <div class="intention-tabs">
                    <button class="intention-tab active" data-tab="release" onclick="switchIntentionSettingsTab('release')">
                        <span class="tab-icon">‚Üì</span> Release
                    </button>
                    <button class="intention-tab" data-tab="raise" onclick="switchIntentionSettingsTab('raise')">
                        <span class="tab-icon">‚Üë</span> Raise
                    </button>
                    <button class="intention-tab" data-tab="realize" onclick="switchIntentionSettingsTab('realize')">
                        <span class="tab-icon">‚ú¶</span> Realize
                    </button>
                </div>

                <!-- Release Tab Content -->
                <div class="intention-settings-content active" id="intentionSettingsRelease">
                    <div class="intention-card" onclick="editIntention('release_beliefs')">
                        <div class="intention-card-header">
                            <span class="intention-label">Limiting Beliefs & Blocks</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_release_beliefs">What beliefs hold you back? Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('release_emotions')">
                        <div class="intention-card-header">
                            <span class="intention-label">Negative Patterns</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_release_emotions">What emotions do you want to release? Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('release_trauma')">
                        <div class="intention-card-header">
                            <span class="intention-label">Trauma & Habits</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_release_trauma">What patterns are you ready to let go of? Tap to add...</p>
                    </div>
                </div>

                <!-- Raise Tab Content -->
                <div class="intention-settings-content" id="intentionSettingsRaise">
                    <div class="intention-card" onclick="editIntention('raise_consciousness')">
                        <div class="intention-card-header">
                            <span class="intention-label">Consciousness & Presence</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_raise_consciousness">Describe your vision of living fully present. Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('raise_intelligences')">
                        <div class="intention-card-header">
                            <span class="intention-label">Developing Capacities</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_raise_intelligences">Which intelligences do you want to strengthen? Tap to add...</p>
                    </div>
                </div>

                <!-- Realize Tab Content -->
                <div class="intention-settings-content" id="intentionSettingsRealize">
                    <div class="intention-card" onclick="editIntention('realize_health')">
                        <div class="intention-card-header">
                            <span class="intention-label">Health & Vitality</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_realize_health">Describe your optimal state of health. Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('realize_wealth')">
                        <div class="intention-card-header">
                            <span class="intention-label">Abundance & Purpose</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_realize_wealth">What does fulfilling work look like for you? Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('realize_relationships')">
                        <div class="intention-card-header">
                            <span class="intention-label">Relationships & Connection</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_realize_relationships">Describe the quality of relationships you want. Tap to add...</p>
                    </div>

                    <div class="intention-card" onclick="editIntention('realize_other')">
                        <div class="intention-card-header">
                            <span class="intention-label">Other Intentions</span>
                            <span class="intention-edit">‚úé</span>
                        </div>
                        <p class="intention-preview" id="settings_preview_realize_other">Any other goals or dreams? Tap to add...</p>
                    </div>
                </div>

                <p class="privacy-note">üîí Your intentions are private and only visible to you.</p>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <button class="nav-btn active" onclick="showView('dashboard')" data-view="dashboard">
                <span class="nav-icon">‚åÇ</span>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-btn" onclick="showView('signal')" data-view="signal">
                <span class="nav-icon">‚ö°</span>
                <span class="nav-label">Signal</span>
            </button>
            <button class="nav-btn" onclick="showView('awaken')" data-view="awaken">
                <span class="nav-icon">‚ú¶</span>
                <span class="nav-label">Recognize</span>
            </button>
            <button class="nav-btn" onclick="showView('timer')" data-view="timer">
                <span class="nav-icon">‚è±</span>
                <span class="nav-label">Energy</span>
            </button>
            <button class="nav-btn" onclick="showView('settings')" data-view="settings">
                <span class="nav-icon">‚öô</span>
                <span class="nav-label">Settings</span>
            </button>
        </nav>

        <!-- Add User Modal -->
        <div id="addUserModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add User</h3>
                    <button class="close-btn" onclick="closeAddUserModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="newUserName" placeholder="Enter name">
                    </div>
                    <div class="form-group">
                        <label>Notes (optional)</label>
                        <textarea id="newUserNotes" placeholder="Any notes about this user"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeAddUserModal()">Cancel</button>
                    <button class="btn primary" onclick="addUser()">Add User</button>
                </div>
            </div>
        </div>

        <!-- Add Marker Modal -->
        <div id="addMarkerModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add Custom Marker</h3>
                    <button class="close-btn" onclick="closeAddMarkerModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Category</label>
                        <select id="newMarkerCategory">
                            <option value="Custom">Custom</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="newMarkerName" placeholder="Enter marker name">
                    </div>
                    <div class="form-group">
                        <label>Description (optional)</label>
                        <textarea id="newMarkerDescription" placeholder="What does this marker track?"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeAddMarkerModal()">Cancel</button>
                    <button class="btn primary" onclick="addMarker()">Add Marker</button>
                </div>
            </div>
        </div>

        <!-- Exit Session Confirmation Modal -->
        <div id="exitSessionModal" class="modal">
            <div class="modal-content small">
                <div class="modal-body" style="text-align: center; padding: var(--space-xl);">
                    <p style="font-size: 1rem; margin-bottom: var(--space-lg);">Are you sure you want to exit?</p>
                    <p style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: var(--space-xl);">Your progress in this session will be lost.</p>
                    <div style="display: flex; gap: var(--space-md); justify-content: center;">
                        <button class="btn secondary" onclick="closeExitModal()">Stay</button>
                        <button class="btn danger" onclick="exitSession()">Exit</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Intention Edit Modal -->
        <div id="intentionModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="intentionModalTitle">Edit Intention</h3>
                    <button class="close-btn" onclick="closeIntentionModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <p class="intention-helper" id="intentionHelper">Describe your intention...</p>
                    <textarea id="intentionTextarea" rows="8" placeholder="Take your time to articulate what you truly want..."></textarea>
                </div>
                <div class="modal-footer">
                    <button class="btn secondary" onclick="closeIntentionModal()">Cancel</button>
                    <button class="btn primary" onclick="saveIntention()">Save</button>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div class="toast-container" id="toastContainer"></div>
    </div>

    <script src="app.js"></script>
</body>
</html>
